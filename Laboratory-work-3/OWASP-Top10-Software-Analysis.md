# OWASP Top 10 2021: Detailed Software Vulnerabilities Analysis for Weather Station

| **Ідентифікатор та назва атаки (вразливості)**         | **Вимога(и) (FR, NFR)**                                    | **Загроза порушення**                                   | **Приклад запобігання успішної реалізації атаки**                |
|--------------------------------------------------------|------------------------------------------------------------|---------------------------------------------------------|------------------------------------------------------------------|
| **A1 - Недоліки контролю доступу**                     | NFR7 – Захист від несанкціонованого доступу                | Порушення конфіденційності                              | Впровадження чіткої моделі доступу на основі ролей користувачів із обмеженим доступом до критичних функцій метеостанції. Використання контролю доступу на рівні серверу для перевірки прав кожного запиту. |
| **A2 - Невдачі у криптографії**                        | NFR2 – Захищена передача даних, FR4 – Збереження даних у базі даних, FR5 – Передача даних між Arduino та сервером | Порушення конфіденційності та цілісності                | Використання надійного TLS шифрування для всіх передач даних між компонентами метеостанції. Застосування сучасних криптографічних протоколів для захисту даних у базі даних і під час передачі, а також регулярне оновлення сертифікатів. |
| **A3 - Впровадження (Injection)**                      | NFR7 – Захист від несанкціонованого доступу, FR4 – Збереження даних у базі даних  | Порушення цілісності даних                              | Виконання валідації та очищення всіх користувацьких введень для запобігання SQL-ін’єкціям. Використання підготовлених запитів (prepared statements) і ORM для обробки запитів до бази даних, щоб уникнути безпосередньої взаємодії з SQL. |
| **A4 - Небезпечний дизайн**                            | FR4 – Збереження даних у базі даних, FR5 – Передача даних між Arduino та сервером | Порушення цілісності                                     | Проведення аналізу архітектури з урахуванням загроз ще на етапі проектування. Використання методологій, таких як STRIDE або DREAD, для ідентифікації потенційних ризиків та застосування сучасних стандартів безпеки для забезпечення надійного дизайну. |
| **A5 - Неправильна конфігурація безпеки**              | NFR10 – Моніторинг і підтримка системи, NFR5 – Масштабованість системи | Порушення доступності                                   | Регулярне налаштування та перевірка конфігураційних файлів для забезпечення безпеки. Автоматизація перевірок конфігурацій за допомогою сканерів конфігурації безпеки та використання інструментів для виявлення неправильно налаштованих служб або відкритих портів. |
| **A6 - Вразливі та застарілі компоненти**              | NFR10 – Моніторинг і підтримка системи, NFR6 – Надійність метеостанції | Порушення доступності                                   | Постійне оновлення бібліотек і компонентів, використання тільки підтримуваних версій. Виконання регулярних перевірок на наявність оновлень та використання інструментів для відстеження вразливостей у бібліотеках, таких як Dependabot або Snyk. |
| **A7 - Помилки ідентифікації та автентифікації**       | NFR7 – Захист від несанкціонованого доступу, FR2 – Відображення даних на веб/Telegram-боті | Порушення конфіденційності                              | Впровадження багатофакторної автентифікації (MFA) для підвищення рівня захисту облікових записів користувачів. Застосування складних паролів і обмеження кількості спроб входу, а також використання CAPTCHA для запобігання автоматизованим атакам. |
| **A8 - Невдачі у забезпеченні цілісності ПЗ**          | NFR2 – Захищена передача даних, FR4 – Збереження даних у базі даних | Порушення цілісності                                     | Впровадження механізмів перевірки цілісності даних під час зберігання та передачі, наприклад, хешування контрольних сум. Регулярна перевірка цілісності компонентів і використання цифрових підписів для підтвердження автентичності програмного забезпечення. |
| **A9 - Невдачі реєстрації та моніторингу безпеки**     | NFR10 – Моніторинг і підтримка системи, FR3 – Прогнозування погодних умов | Порушення доступності                                   | Впровадження централізованого моніторингу безпеки з налаштуванням детального журналювання всіх важливих подій. Використання інструментів SIEM для виявлення підозрілої активності в реальному часі та забезпечення оперативного реагування. |
| **A10 - Підробка запитів на стороні сервера (SSRF)**   | FR5 – Передача даних між Arduino та сервером, FR4 – Збереження даних у базі даних | Порушення цілісності                                     | Перевірка автентичності всіх вхідних запитів шляхом додавання токенів автентифікації. Використання білого списку дозволених IP-адрес і обмеження доступу до внутрішніх ресурсів з публічної мережі для запобігання підробці запитів. |
