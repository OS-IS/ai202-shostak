# Проведення розвідки витоку інформації в пошукових системах

## Огляд

Для того, щоб пошукові системи працювали, комп'ютерні програми (або `роботи`) регулярно отримують дані (так зване [сканування](https://en.wikipedia.org/wiki/Web_crawler)) з мільярдів сторінок в Інтернеті. Ці програми знаходять веб-контент і функціональність, переходячи за посиланнями з інших сторінок або переглядаючи карти сайтів. Якщо веб-сайт використовує спеціальний файл `robots.txt` для переліку сторінок, які він не хоче, щоб пошукові системи отримували, то перелічені в ньому сторінки будуть проігноровані. Це базовий огляд - Google пропонує більш поглиблене пояснення того, [як працює пошукова система](https://support.google.com/webmasters/answer/70897?hl=en).

Тестувальники можуть використовувати пошукові системи для проведення розвідки веб-сайтів і веб-додатків. Існують прямі та непрямі елементи виявлення та розвідки пошукових систем: прямі методи пов'язані з пошуком індексів та відповідного контенту в кеші, тоді як непрямі методи пов'язані з вивченням конфіденційної інформації про дизайн та конфігурацію шляхом пошуку на форумах, в групах новин та на веб-сайтах, що проводять тендери.

Після того, як робот пошукової системи завершив сканування, він починає індексувати вміст сайту на основі тегів і пов'язаних з ними атрибутів, таких як `<TITLE>`, для того, щоб повернути релевантні результати пошуку. Якщо файл `robots.txt` не оновлювався протягом усього часу існування веб-сайту, а вбудовані мета-теги HTML, які вказують роботам не індексувати вміст, не використовувалися, то в індекс може потрапити веб-вміст, який не планувався власниками. Власники веб-сайтів можуть використовувати вищезгадані `robots.txt`, мета-теги HTML, аутентифікацію та інструменти, що надаються пошуковими системами, для видалення такого контенту.

## Цілі тестування

- Визначення, яка конфіденційна інформація про дизайн і конфігурацію програми, системи або організації доступна безпосередньо (на веб-сайті організації) або опосередковано (через сторонні сервіси).

## Як тестувати

Скористайтеся пошуковою системою для пошуку потенційно конфіденційної інформації. Це може включати в себе

- схеми та конфігурації мережі

- архівні повідомлення та електронні листи адміністраторів або іншого ключового персоналу

- процедури входу в систему та формати імен користувачів;

- імена користувачів, паролі та приватні ключі;

- конфігураційні файли сторонніх або хмарних сервісів;

- розкриття змісту повідомлень про помилки; і

- розробка, тестування, User Acceptance Testing (UAT) і постановочні версії сайтів.

#### Пошукові системи

Не обмежуйте тестування лише однією пошуковою системою, оскільки різні пошукові системи можуть видавати різні результати. Результати пошукової системи можуть відрізнятися за кількома параметрами, залежно від того, коли система востаннє сканувала контент, а також від алгоритму, який вона використовує для визначення релевантних сторінок. Розглянемо можливість використання наступних (в алфавітному порядку) пошукових систем:

- [Baidu](https://www.baidu.com/), [найпопулярніша](https://en.wikipedia.org/wiki/Web_search_engine#Market_share) пошукова система в Китаї.

- [Bing](https://www.bing.com/), пошукова система, що належить і управляється Microsoft, друга [за популярністю](https://en.wikipedia.org/wiki/Web_search_engine#Market_share) у світі. Підтримує [розширений пошук за ключовими словами](http://help.bing.microsoft.com/#apex/18/en-US/10001/-1).

- [binsearch.info](https://binsearch.info/), пошукова система для бінарних груп новин Usenet.

- [Common Crawl](https://commoncrawl.org/), «відкрите сховище даних веб-сканування, до якого може отримати доступ і проаналізувати будь-хто».

- [DuckDuckGo](https://duckduckgo.com/), пошукова система, орієнтована на конфіденційність, яка компілює результати з багатьох різних [джерел](https://help.duckduckgo.com/results/sources/). Підтримує [синтаксис пошуку](https://help.duckduckgo.com/duckduckgo-help-pages/results/syntax/).

- [Google](https://www.google.com/) - [найпопулярніша](https://en.wikipedia.org/wiki/Web_search_engine#Market_share) пошукова система у світі, яка використовує систему ранжування, щоб намагатися повернути найбільш релевантні результати. Підтримує [пошукові оператори](https://support.google.com/websearch/answer/2466433).

- [Інтернет-архів Wayback Machine](https://archive.org/web/), «створення цифрової бібліотеки інтернет-сайтів та інших культурних артефактів у цифровому вигляді».

- [Startpage](https://www.startpage.com/), пошукова система, яка використовує результати Google без збору особистої інформації через трекери та журнали. Підтримує [пошукових операторів](https://support.startpage.com/index.php?/Knowledgebase/Article/View/989/0/advanced-search-which-search-operators-are-supported-by-startpagecom).

- [Shodan](https://www.shodan.io/)- сервіс для пошуку підключених до Інтернету пристроїв і сервісів. Варіанти використання включають обмежений безкоштовний план, а також платні плани підписки.

І DuckDuckGo, і Startpage пропонують користувачам підвищену конфіденційність, оскільки не використовують трекери і не ведуть логів. Це може зменшити витік інформації про тестувальника.

### Пошукові оператори

Оператор пошуку - це спеціальне ключове слово або синтаксис, який розширює можливості звичайних пошукових запитів і може допомогти отримати більш конкретні результати. Зазвичай вони мають вигляд `оператор:запит`. Ось деякі поширені пошукові оператори:

- `site:` обмежить пошук вказаним доменом.

- `inurl:` поверне тільки ті результати, які містять ключове слово в URL-адресі.

- `intitle:` поверне лише ті результати, які містять ключове слово в заголовку сторінки.

- `intext:` або `inbody:` шукатиме ключове слово лише в тексті сторінки.

- `filetype:` буде відповідати лише певному типу файлу, наприклад, png або php.

Наприклад, щоб знайти вміст сайту owasp.org, проіндексований типовою пошуковою системою, потрібно використовувати такий синтаксис:

```
site:owasp.org
```

![Приклад результату пошуку роботи сайту в Google](https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/01-Information_Gathering/images/Google_site_Operator_Search_Results_Example_20200406.png"*Малюнок 4.1.1-1: Google Site Operation Search Result Example*")

### Перегляд кешованого вмісту

Для пошуку вмісту, який вже було проіндексовано, використовуйте оператор `cache:`. Це корисно для перегляду вмісту, який міг змінитися з часу його індексації або який може бути більше недоступним. Не всі пошукові системи надають кешований вміст для пошуку; найкориснішим джерелом на момент написання статті є Google.

Щоб переглянути `owasp.org` укешованому вигляді, скористайтеся синтаксисом:

```
cache:owasp.org
```

![Приклад результату пошуку в кеші Google](https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/01-Information_Gathering/images/Google_cache_Operator_Search_Results_Example_20200406.png"*Малюнок 4.1.1-2: Google Site Operation Search Result Example*")

### Хакерство в Google, або Dorking

Пошук за допомогою операторів може бути дуже ефективною технікою виявлення в поєднанні з творчим підходом тестувальника. Операторів можна залучити до ефективного пошуку певних типів конфіденційних файлів та інформації. Цей метод, який називається [злом Google](https://en.wikipedia.org/wiki/Google_hacking) або доркінг, також можливий з використанням інших пошукових систем, якщо вони підтримують операторів пошуку.

База даних хакерів, така як [Google Hacking Database](https://www.exploit-db.com/google-hacking-database), є корисним ресурсом, який може допомогти виявити певну інформацію. У цій базі даних можна знайти деякі категорії придурків:

- Точки опори

- Файли, що містять імена користувачів

- Чутливі каталоги

- Виявлення веб-серверів

- Вразливі файли

- Вразливі сервери

- Повідомлення про помилки

- Файли, що містять важливу інформацію

- Файли, що містять паролі

- Делікатна інформація про покупки в Інтернеті

Бази даних для інших пошукових систем, таких як Bing і Shodan, доступні на таких ресурсах, як Bishop Fox's [Google Hacking Diggity Project](https://resources.bishopfox.com/resources/tools/google-hacking-diggity/).

## Виправлення

Ретельно зважуйте чутливість інформації про дизайн та конфігурацію, перш ніж публікувати її в Інтернеті.

Періодично переглядайте чутливість наявної інформації про дизайн та конфігурацію, яка публікується в Інтернеті.